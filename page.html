<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
	<script type="text/javascript"> 

(function() { 
    if ("-ms-user-select" in document.documentElement.style && navigator.userAgent.match(/IEMobile\/10\.0/)) { 
        var msViewportStyle = document.createElement("style"); 
        msViewportStyle.appendChild( 
            document.createTextNode("@-ms-viewport{width:auto!important}") 
        ); 
        document.getElementsByTagName("head")[0].appendChild(msViewportStyle); 
    } 
})(); 

</script>
	
</head>
<body>
<button class="btn btn-primary" onclick="play()">Play</button>
<button class="btn btn-primary" onclick="pause()">Pause</button>
<button class="btn btn-primary" onclick="stop()">Stop</button>
<button class="btn btn-primary" onclick="next()">&gt&gt</button>

<button class="btn btn-primary" onclick="inc_vol()">+</button>
<button class="btn btn-primary" onclick="dec_vol()">-</button>


<hr>
<br>

<div class="row">
    <div class="col-sm-1">
        <!--spacer-->
    </div>
    <div class="col-sm-3">
        <ul class="list-group" id="artists">
        </ul>
    </div>
    <div class="col-sm-3">
        <ul id="songs" class="list-group">

        </ul>
    </div>


</div>


<script>



var request = new XMLHttpRequest();
request.open("GET", document.URL + "artists");
request.onreadystatechange = function() { //Call a function when the state changes.
    if (request.readyState == 4 && request.status == 200) {
        data = JSON.parse(request.response)
        var artists = document.getElementById("artists");
        data.forEach(function(item) {
            var listItem = document.createElement("li");
            listItem.className = "list-group-item"
            var name = document.createTextNode(item);
            listItem.onclick = getSongs;
            listItem.appendChild(name);
            artists.appendChild(listItem);
        });
    }
}
request.send();



var selectedArtist = ''

function getSongs() {
    selectedArtist = this.innerHTML;
    var songRequest = new XMLHttpRequest();
    songRequest.open("GET", document.URL + "songs/" + this.innerHTML)
    songRequest.onreadystatechange = function() { //Call a function when the state changes.
        if (songRequest.readyState == 4 && songRequest.status == 200) {
            data = JSON.parse(songRequest.response);
            songList = document.getElementById("songs");

            songList.innerHTML = "";
            data.forEach(function(item) {
                var listItem = document.createElement("li");
                var text = document.createElement("div");
                text.className = "song";
                text.innerText = item;
                text.style.display = "inline-block";
                var listItemButton = document.createElement("btn");
                listItemButton.className = "btn btn-primary";
                listItemButton.style.marginRight = "5%";
                listItemButton.appendChild(document.createTextNode("+"));
                listItemButton.onclick = addSong;
                listItem.className = "list-group-item"
                text.onclick = playSong;
                listItem.appendChild(listItemButton);
                listItem.appendChild(text);
                songList.appendChild(listItem);
            });

        }
    }
    songRequest.send();
};

function inc_vol(){
    var vol_inc_request = new XMLHttpRequest();
    vol_inc_request.open("PUT", document.URL + "volume/up");
    vol_inc_request.send()
}

function dec_vol(){
    var vol_dec_request = new XMLHttpRequest();
    vol_dec_request.open("PUT", document.URL + "volume/down");
    vol_dec_request.send()
}

function playSong() {
    var song = this.innerText
    var artist = selectedArtist;
    var playRequest = new XMLHttpRequest();
    playRequest.open("PUT", document.URL + "play/" + artist + "/" + song);
    playRequest.send();
}

function addSong(){
    var song = this.parentNode.getElementsByClassName("song")[0].innerText;
    var artist = selectedArtist;
    var addRequest = new XMLHttpRequest();
    addRequest.open("PUT", document.URL + "add" + "/" + artist + "/" + song)
    addRequest.send();
}

function play() {
    var playRequest = new XMLHttpRequest();
    playRequest.open("PUT", document.URL + "play");
    playRequest.send();
    }

function pause() {
    var pauseRequest = new XMLHttpRequest();
    pauseRequest.open("PUT", document.URL + "pause");
    pauseRequest.send();
}

function stop() {
    var stopRequest = new XMLHttpRequest();
    stopRequest.open("PUT", document.URL + "stop");
    stopRequest.send();
}

function next(){
    var nextRequest = new XMLHttpRequest();
    nextRequest.open("PUT", document.URL + "next");
    nextRequest.send();
}




</script>
</body>
</html>